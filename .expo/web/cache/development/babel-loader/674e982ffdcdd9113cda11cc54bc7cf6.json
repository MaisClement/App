{"ast":null,"code":"import _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { useRoute, useNavigation, NavigationContainer } from '@react-navigation/native';\nimport { ProgressBar, Colors } from 'react-native-paper';\nimport Error from \"./error\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nfunction Gare_1(_ref) {\n  var route = _ref.route,\n      navigation = _ref.navigation;\n  var _route$params = route.params,\n      stop = _route$params.stop,\n      stopName = _route$params.stopName;\n  return _jsx(Gare_Home, {\n    stop: stop,\n    stopName: stopName\n  });\n}\n\nvar Gare_Home = function (_React$Component) {\n  _inherits(Gare_Home, _React$Component);\n\n  var _super = _createSuper(Gare_Home);\n\n  function Gare_Home(props) {\n    var _this;\n\n    _classCallCheck(this, Gare_Home);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      train: [],\n      stop: _this.props.stop,\n      error: '',\n      error_message: '',\n      code: 0\n    };\n\n    _this.getTrains();\n\n    return _this;\n  }\n\n  _createClass(Gare_Home, [{\n    key: \"getTrains\",\n    value: function getTrains() {\n      var _this2 = this;\n\n      var stop = this.state.stop;\n      var type = 'departure';\n      var url = 'https://api.mylines.fr/sncf/' + type + '?stop=' + stop + '&count=10';\n      fetch(url, {\n        method: 'get'\n      }).then(function (res) {\n        return res.json();\n      }).then(function (data) {\n        if (data.error && data.error == '200') {\n          _this2.setState({\n            error: ':/',\n            error_message: 'La gare indiqué ne semble pas exister. Vérifier l\\'url saisie ou réessayez dans quelques minutes.'\n          });\n        } else if (data.error) {\n          _this2.setState({\n            error: 'Erreur : ' + data.error,\n            error_message: data.error_message\n          });\n        } else {\n          _this2.setState({\n            train: data.trains\n          });\n        }\n      }).catch(function (error) {\n        _this2.setState({\n          error: url,\n          error_message: error.message\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return _jsx(ScrollView, {\n        style: styles.container,\n        children: this.state.error != 0 || this.state.error != '' ? _jsx(Error, {\n          error: this.state.error,\n          error_message: this.state.error_message\n        }) : _jsx(_Fragment, {\n          children: this.state.train.length == 0 ? _jsx(ActivityIndicator, {\n            size: \"large\",\n            color: \"#ffffff\",\n            style: styles.activity\n          }) : _jsxs(View, {\n            className: \"mobile-global\",\n            children: [_jsx(View, {\n              children: _jsx(Text, {\n                children: stopName\n              })\n            }), this.state.train.map(function (train, i) {\n              return _jsx(Train, {\n                train: train,\n                number: i,\n                type: _this3.props.type\n              }, i);\n            })]\n          })\n        })\n      });\n    }\n  }]);\n\n  return Gare_Home;\n}(React.Component);\n\nvar Train = function (_React$Component2) {\n  _inherits(Train, _React$Component2);\n\n  var _super2 = _createSuper(Train);\n\n  function Train(props) {\n    var _this4;\n\n    _classCallCheck(this, Train);\n\n    _this4 = _super2.call(this, props);\n    _this4.state = {\n      width: window.innerWidth\n    };\n    _this4.handleResize = _this4.handleResize.bind(_assertThisInitialized(_this4));\n    return _this4;\n  }\n\n  _createClass(Train, [{\n    key: \"handleResize\",\n    value: function handleResize(e) {\n      this.setState({\n        width: window.innerWidth\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener(\"resize\", this.handleResize);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.addEventListener(\"resize\", this.handleResize);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (typeof this.props.train === 'undefined') {\n        return _jsx(_Fragment, {});\n      }\n\n      var head;\n      if (this.props.type == 'departure') head = this.props.train.informations.direction.name;else head = this.props.train.informations.origin.name;\n      var network = this.props.train.informations.network;\n      var code = this.props.train.informations.code;\n      var name = this.props.train.informations.trip_name;\n      var real_time;\n      var base_time;\n      var created_base_time;\n\n      if (this.props.type == 'departure') {\n        if (typeof this.props.train.stop_date_time.base_departure_date_time !== 'undefined') {\n          created_base_time = createDate(this.props.train.stop_date_time.base_departure_date_time);\n          base_time = this.props.train.stop_date_time.base_departure_date_time;\n        } else {\n          created_base_time = createDate(this.props.train.stop_date_time.departure_date_time);\n          base_time = this.props.train.stop_date_time.departure_date_time;\n        }\n\n        real_time = this.props.train.stop_date_time.departure_date_time;\n      } else {\n        if (typeof this.props.train.stop_date_time.base_arrival_date_time !== 'undefined') {\n          created_base_time = createDate(this.props.train.stop_date_time.base_arrival_date_time);\n          base_time = this.props.train.stop_date_time.base_arrival_date_time;\n        } else {\n          created_base_time = createDate(this.props.train.stop_date_time.arrival_date_time);\n          base_time = this.props.train.stop_date_time.arrival_date_time;\n        }\n\n        real_time = this.props.train.stop_date_time.arrival_date_time;\n      }\n\n      var status = this.props.train.informations.status;\n      var message = this.props.train.informations.message;\n      return _jsxs(View, {\n        children: [_jsxs(View, {\n          style: styles.block,\n          children: [_jsxs(View, {\n            children: [_jsxs(View, {\n              style: styles.block_head,\n              children: [_jsx(Image, {\n                style: styles.class_img,\n                source: 'https://mylines.fr/embed.php?serv=' + network\n              }), _jsx(Text, {\n                style: styles.head,\n                children: head\n              })]\n            }), _jsx(View, {\n              children: _jsx(Text, {\n                style: styles.det,\n                children: code == name ? _jsx(_Fragment, {\n                  children: code\n                }) : _jsxs(_Fragment, {\n                  children: [code, \" - \", name]\n                })\n              })\n            })]\n          }), _jsxs(View, {\n            children: [_jsx(View, {\n              children: _jsxs(Text, {\n                style: styles.time,\n                children: [created_base_time.getHours() < 10 ? '0' + created_base_time.getHours() : created_base_time.getHours(), \":\", created_base_time.getMinutes() < 10 ? '0' + created_base_time.getMinutes() : created_base_time.getMinutes()]\n              })\n            }), _jsx(View, {\n              children: _jsx(Info, {\n                real_time: real_time,\n                base_time: base_time,\n                status: status,\n                message: message\n              })\n            })]\n          })]\n        }), _jsx(View, {\n          style: styles.space\n        })]\n      });\n    }\n  }]);\n\n  return Train;\n}(React.Component);\n\nvar Info = function (_React$Component3) {\n  _inherits(Info, _React$Component3);\n\n  var _super3 = _createSuper(Info);\n\n  function Info() {\n    _classCallCheck(this, Info);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Info, [{\n    key: \"render\",\n    value: function render() {\n      var real_time = this.props.real_time;\n      var base_time = this.props.base_time;\n      var status = this.props.status;\n      var message = this.props.message;\n      if (status == 'deleted') return _jsx(\"span\", {\n        className: \"deleted\",\n        children: \" supprim\\xE9 \"\n      });\n      if (status == 'late') return _jsx(\"span\", {\n        className: \"late\",\n        children: \" retard\\xE9 \"\n      });\n      if (status == 'real_time') return _jsx(\"span\", {\n        className: \"late\",\n        children: \" temps r\\xE9el \"\n      });\n      if (message == 'idf') return _jsx(\"span\", {\n        className: \"info\",\n        children: \" th\\xE9orique \"\n      });\n      real_time = createDate(real_time);\n      base_time = createDate(base_time);\n\n      if (real_time < base_time) {\n        real_time.setDate(real_time.getDate());\n      }\n\n      var diff = real_time - base_time;\n      var msec = diff;\n      var hh = Math.floor(msec / 1000 / 60 / 60);\n      msec -= hh * 1000 * 60 * 60;\n      var mm = Math.floor(msec / 1000 / 60);\n      msec -= mm * 1000 * 60;\n\n      if (mm > 0) {\n        if (message == 'idf_realtime') {\n          if (hh == 0 && mm <= 5) return _jsxs(\"span\", {\n            className: \"info\",\n            children: [\" + \", mm, \" min \"]\n          });else if (hh == 0) return _jsxs(\"span\", {\n            className: \"late\",\n            children: [\" + \", mm, \" min \"]\n          });else return _jsxs(\"span\", {\n            className: \"late\",\n            children: [\" + \", hh, \"h\", mm, \" \"]\n          });\n        } else {\n          if (hh == 0) return _jsxs(\"span\", {\n            className: \"late\",\n            children: [\" retard : \", mm, \" min \"]\n          });else return _jsxs(\"span\", {\n            className: \"late\",\n            children: [\" retard : \", hh, \"h\", mm, \" \"]\n          });\n        }\n      } else if (typeof this.props.displayAll !== 'undefined') return _jsx(\"span\", {\n        className: \"info\",\n        children: \" \\xE0 l'heure \"\n      });else return _jsx(_Fragment, {});\n    }\n  }]);\n\n  return Info;\n}(React.Component);\n\nfunction createDate(date) {\n  var el = new Date(date.substring(0, 4), date.substring(4, 6), date.substring(6, 8), date.substring(9, 11), date.substring(11, 13), 0, 0);\n  return el;\n}\n\nexport default Gare_1;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#2b1922'\n  },\n  activity: {\n    marginTop: 50\n  },\n  title: {\n    fontSize: 30,\n    textAlign: 'left',\n    fontWeight: 'bold',\n    color: '#fff',\n    margin: 23\n  },\n  block: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    alignItems: 'baseline',\n    justifyContent: 'space-between',\n    padding: 10\n  },\n  block_head: {\n    flexDirection: 'row',\n    flexWrap: 'wrap'\n  },\n  class_img: {\n    width: 70,\n    height: 23,\n    resizeMode: 'contain'\n  },\n  head: {\n    fontSize: 20,\n    fontWeight: '100',\n    padding: '10',\n    color: '#fff'\n  },\n  time: {\n    fontSize: 25,\n    fontWeight: '700',\n    padding: '10',\n    color: '#fff'\n  },\n  det: {\n    color: '#a4a4a4',\n    fontSize: 15,\n    paddingLeft: 10\n  },\n  space: {\n    backgroundColor: '#868686',\n    marginLeft: 10,\n    marginRight: 10,\n    borderRadius: 2,\n    height: 2\n  }\n});","map":{"version":3,"sources":["/home/code/app/gare_1.js"],"names":["React","useRoute","useNavigation","NavigationContainer","ProgressBar","Colors","Error","Gare_1","route","navigation","params","stop","stopName","Gare_Home","props","state","train","error","error_message","code","getTrains","type","url","fetch","method","then","res","json","data","setState","trains","catch","message","styles","container","length","activity","map","i","Component","Train","width","window","innerWidth","handleResize","bind","e","addEventListener","head","informations","direction","name","origin","network","trip_name","real_time","base_time","created_base_time","stop_date_time","base_departure_date_time","createDate","departure_date_time","base_arrival_date_time","arrival_date_time","status","block","block_head","class_img","det","time","getHours","getMinutes","space","Info","setDate","getDate","diff","msec","hh","Math","floor","mm","displayAll","date","el","Date","substring","StyleSheet","create","flex","backgroundColor","marginTop","title","fontSize","textAlign","fontWeight","color","margin","flexDirection","flexWrap","alignItems","justifyContent","padding","height","resizeMode","paddingLeft","marginLeft","marginRight","borderRadius"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { RefreshControl, Pressable, StatusBar, SafeAreaView, ActivityIndicator, ScrollView, StyleSheet, Text, TextInput, View, Image  } from 'react-native';\nimport { useRoute, useNavigation, NavigationContainer } from '@react-navigation/native';\nimport { ProgressBar, Colors } from 'react-native-paper';\n\nimport Error from './error'\n\nfunction Gare_1 ({ route, navigation }){\n  const { stop, stopName } = route.params;\n\n  return (  <Gare_Home\n              stop = {stop}\n              stopName = {stopName}\n            />\n          );\n}\n  \nclass Gare_Home extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            train: [],\n            stop: this.props.stop,\n\n            error: '',\n            error_message: '',\n            code: 0,\n        };\n        this.getTrains();\n\t}\n\t\n    getTrains() {\n        let stop = this.state.stop;\n        // let type = this.props.type;\n        let type = 'departure';\n        let url = 'https://api.mylines.fr/sncf/' + type + '?stop=' + stop + '&count=10';\n            \n        fetch(url, {\n            method: 'get'\n        })\n        .then(res => res.json())\n        .then(data => {\n            if (data.error && data.error == '200') {\n                this.setState({\n                    error: ':/',\n                    error_message: 'La gare indiqué ne semble pas exister. Vérifier l\\'url saisie ou réessayez dans quelques minutes.'\n                }); \n            } else if (data.error) {\n                this.setState({\n                    error: 'Erreur : ' + data.error,\n                    error_message: data.error_message,\n                }); \n            } else {\n                this.setState({\n                    train: data.trains\n                });\n            }\n        })\n        .catch((error) => {\n            this.setState({\n                error: url,\n                error_message: error.message,\n            });\n        });\n    }\n\n\trender(){\n        return(\n            <ScrollView style={styles.container}>\n                {this.state.error != 0 || this.state.error != '' ?\n                        <Error\n                            error = {this.state.error}\n                            error_message = {this.state.error_message}\n                        />\n                    :\n                    <>\n                        {this.state.train.length == 0 ?\n                            <ActivityIndicator size=\"large\" color=\"#ffffff\" style={styles.activity}/>\n                            :\n                            <View className=\"mobile-global\">\n                                <View>\n                                    <Text>{stopName}</Text>\n                                </View>\n                                {this.state.train.map((train, i) => (\n                                    <Train \n                                        key = {i} \n                                        train = {train}\n                                        number = {i}\n                                        type = {this.props.type}\n                                    />\n                                ))}\n                            </View>\n                        }\n                    </>\n                }\n            </ScrollView>\n        )\n    }\n}\nclass Train extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = { width: window.innerWidth };\n\n        this.handleResize = this.handleResize.bind(this);\n    }\n    \n    handleResize(e){\n        this.setState({ width: window.innerWidth });\n    };\n    \n    componentDidMount() {\n        window.addEventListener(\"resize\", this.handleResize);\n    }\n    \n    componentWillUnmount () {\n        window.addEventListener(\"resize\", this.handleResize);\n    } \n\n\trender(){\n        if (typeof this.props.train === 'undefined') {\n            return (\n                <>\n                </>\n            );\n        }\n\n        let head;\n        if (this.props.type == 'departure')\n            head = this.props.train.informations.direction.name;\n        else\n            head = this.props.train.informations.origin.name;\n\n        let network = this.props.train.informations.network;\n        let code = this.props.train.informations.code;\n        let name = this.props.train.informations.trip_name;\n\n        let real_time;\n        let base_time;\n        let created_base_time;\n        \n        if (this.props.type == 'departure'){\n            if (typeof this.props.train.stop_date_time.base_departure_date_time !== 'undefined') {\n                created_base_time = createDate(this.props.train.stop_date_time.base_departure_date_time);\n                base_time = this.props.train.stop_date_time.base_departure_date_time;\n            } else {\n                created_base_time = createDate(this.props.train.stop_date_time.departure_date_time);\n                base_time = this.props.train.stop_date_time.departure_date_time;\n            }\n            real_time = this.props.train.stop_date_time.departure_date_time;\n        } else {\n            if (typeof this.props.train.stop_date_time.base_arrival_date_time !== 'undefined') {\n                created_base_time = createDate(this.props.train.stop_date_time.base_arrival_date_time);\n                base_time = this.props.train.stop_date_time.base_arrival_date_time;\n            } else {\n                created_base_time = createDate(this.props.train.stop_date_time.arrival_date_time);\n                base_time = this.props.train.stop_date_time.arrival_date_time;\n            }\n            real_time = this.props.train.stop_date_time.arrival_date_time;\n        }\n\n        let status = this.props.train.informations.status;\n        let message = this.props.train.informations.message;\n\n        return (\n            <View>\n                <View style={styles.block}>\n                    <View>\n                        <View style={styles.block_head}>\n                            <Image style={styles.class_img} source={'https://mylines.fr/embed.php?serv=' + network}></Image>\n                            <Text style={styles.head}>{head}</Text>\n                        </View>\n                        <View>\n                            <Text style={styles.det}>{code == name ? <>{code}</> : <>{code} - {name}</>}</Text>\n                        </View>\n                    </View>\n                    <View>\n                        <View>\n                            <Text style={styles.time}>{(created_base_time.getHours() < 10) ? '0' + created_base_time.getHours() : created_base_time.getHours()}:{(created_base_time.getMinutes() < 10) ? '0' + created_base_time.getMinutes() : created_base_time.getMinutes()}</Text>\n                        </View>\n                        <View>\n                            <Info real_time={real_time} base_time={base_time} status={status} message={message}/>\n                        </View>\n                    </View>\n                </View>\n               \n                <View style={styles.space}></View>\n            </View>\n        );\n\t}\n}\n\nclass Info extends React.Component {\n\trender(){\n\n        let real_time = this.props.real_time;\n        let base_time = this.props.base_time;\n        let status = this.props.status;\n        let message = this.props.message;\n\n        if (status == 'deleted')\n            return ( <span className=\"deleted\"> supprimé </span> );\n\n        if (status == 'late')\n            return ( <span className=\"late\"> retardé </span> );\n\n        if (status == 'real_time')\n            return ( <span className=\"late\"> temps réel </span> );\n        \n        if (message == 'idf')\n            return ( <span className=\"info\"> théorique </span> );\n\n        real_time = createDate(real_time);\n        base_time = createDate(base_time);\n        \n        \n        if (real_time < base_time) {\n            real_time.setDate(real_time.getDate());\n        }\n        \n        var diff = real_time - base_time;\n        var msec = diff;\n        var hh = Math.floor(msec / 1000 / 60 / 60);\n        msec -= hh * 1000 * 60 * 60;\n        var mm = Math.floor(msec / 1000 / 60);\n        msec -= mm * 1000 * 60;\n\n        if (mm > 0){\n            if (message == 'idf_realtime'){\n                if (hh == 0 && mm <= 5)\n                    return ( <span className=\"info\"> + {mm} min </span> );\n                else if (hh == 0)\n                    return ( <span className=\"late\"> + {mm} min </span> );\n                else \n                    return ( <span className=\"late\"> + {hh}h{mm} </span> );\n            } else {\n                if (hh == 0)\n                    return ( <span className=\"late\"> retard : {mm} min </span> );\n                else \n                    return ( <span className=\"late\"> retard : {hh}h{mm} </span> );\n            }\n        } else if (typeof this.props.displayAll !== 'undefined')\n            return ( <span className=\"info\"> à l'heure </span> );\n        else\n            return ( <></> );\n\t}   \n}\nfunction createDate(date){\n    let el = new Date(date.substring(0, 4), date.substring(4, 6), date.substring(6, 8), date.substring(9, 11), date.substring(11, 13), 0, 0); \n    return el;\n}\n\nexport default Gare_1;\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#2b1922',\n  },\n  activity: {\n    marginTop: 50,\n  },\n  title: {\n    fontSize: 30,\n    textAlign: 'left',\n    fontWeight: 'bold',\n    color: '#fff',\n    margin: 23,\n  },\n  block: {\n    flexDirection:'row',\n    flexWrap:'wrap',\n    alignItems: 'baseline',\n    justifyContent: 'space-between',\n    padding: 10,\n  },\n  block_head: {\n    flexDirection:'row',\n    flexWrap:'wrap',\n  },\n  class_img: {\n    width: 70, \n    height: 23 ,\n    resizeMode: 'contain'\n  },\n  head: {\n    fontSize: 20,\n    fontWeight: '100',\n    padding: '10',\n    color: '#fff',\n  },\n  time: {\n    fontSize: 25,\n    fontWeight: '700',\n    padding: '10',\n    color: '#fff',\n  },\n  det: {\n    color: '#a4a4a4',\n    fontSize: 15,\n    paddingLeft: 10,\n  },\n  space: {\n    backgroundColor: '#868686',\n    marginLeft: 10,\n    marginRight: 10,\n    borderRadius: 2,\n    height: 2,\n  }\n});\n"]},"metadata":{},"sourceType":"module"}